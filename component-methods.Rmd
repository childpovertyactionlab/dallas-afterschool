---
title: "Components and Methods"
output:
  distill::distill_article:
    toc: TRUE
    theme: theme.css
---
```{r, import and set-up, include=FALSE}
library(tidyverse)
library(sf)
library(CPALtools)
#datalib <- "E:/CPAL Dropbox/" # Michael Desktop Directory
datalib <- "C:/Users/micha/CPAL Dropbox/"

dallasCounty <- st_read("data/dallasCounty.geojson") %>%
  st_transform(crs = 4269)

das_metrics <- st_read("data/Calculated Tract Metrics.geojson") %>%
  st_transform(crs = 4269)

dotdensity <- st_read("data/dotdensityPopulation.geojson") %>%
  st_transform(crs = 4269)

```
## Understanding Afterschool Programs in Dallas County
[Introduce the concept of supply and demand as individual components and how they can help identify gaps in Dallas County.]
Dallas Afterschool Programs by Census Tract

```{r, map of DAS afterschool programs in county, echo = FALSE, message=FALSE, warning=FALSE, layout="l-page", fig.height=8}
# Generate Jenks Breaks for plot
brks_das <- c(0, 1, 3, 6, 10)
das_metrics$group <- cut(das_metrics$dasPrograms,
                             breaks = c(0, 1, 3, 6, 10),
                       include.lowest = TRUE)

labs_das <- round(brks_das*100)

# Generate labels based on Jenks breaks for plot
#labs_plot <- paste0("(", labs_das[1:5], "% - ", labs_cbp[2:6], "%)")

# Generate palette for plot
pal_das <- hcl.colors(4, "BuPu", alpha = 0.9, rev = TRUE)


# Generate Plot
ggplot() +
  geom_sf(data = das_metrics, aes(fill = dasPrograms), color = "#595959") +
#  scale_fill_manual(values = pal_das,
#                    drop = FALSE,
#                    na.value = "#000000",
#                    #label = labs_plot,
#                    guide = guide_legend(direction = "vertical",
#                                         nrow = 6,
#                                         label.position = "right")) +
  geom_sf(data = dallasCounty, color = "#323232", fill = NA, size = 1) #+
#  geom_sf(data = DallasMajor, color = "#323232", size = 0.3) +
#  geom_sf(data = DallasHighway, color = "#323232", size = 0.6) +
#  labs(title = "Child Poverty Rate in the City of Dallas",
#       subtitle = "U.S. Census Bureau, American Community Survey 5-Year Estimates 2020",
#       x = "",
#       y = "",
#       color = "") +
#  theme_cpal() #+
#  theme(legend.position = "right",
#        legend.key.width = unit(0.5, units = "in"),
#        plot.caption = element_text(size = 36, face = "italic"),
#        legend.spacing = unit(0, "in"), 
#        legend.key.height = unit(0.25, "in"), 
#        legend.spacing.x = unit(0.1, "in"), 
#        legend.justification = "center",
#        legend.margin=margin(4,4,4,4),
#        legend.box.spacing = margin(0.5))

```

Population dot density by race/ethnicity

```{r, dot density population, echo = FALSE, message=FALSE, warning=FALSE, layout="l-page", fig.height=8}
ggplot() +
  geom_sf(data = dotdensity,
          aes(color = variable),
          size = 0.05) +
#  geom_sf(data = DallasSimple, color = "#323232", fill = NA, size = 1) +
#  geom_sf(data = DallasMajor, color = "#323232", size = 0.3) +
#  geom_sf(data = DallasHighway, color = "#323232", size = 0.6) +
  scale_color_manual(values = pal_cpalfac) #+
#  labs(title = "Dot Density Map of North Texas Race/Ethnicity",
#       subtitle = "1 Dot Per 25 Residents",
#       caption = "U.S. Census Bureau, 2020 Census",
#       x = "",
#       y = "",
#       color = "") +
#  theme_cpal() +
#  theme(legend.position = "bottom",
#        legend.key.width = unit(0.5, units = "in"),
#        plot.caption = element_text(size = 36, face = "italic"),
#        legend.spacing = unit(0, "in"), 
#        legend.key.height = unit(0.25, "in"), 
#        legend.spacing.x = unit(0.1, "in"), 
#        legend.justification = "center",
#        legend.margin=margin(4,4,4,4),
#        legend.box.spacing = margin(0.5)) +
#  guides(colour = guide_legend(override.aes = list(size=10)))

```
## Existing Afterschool Environment

[Describe metrics included in Existing Afterschool Environment and reasons for their inclusion]

### Summary of Current Programs

[Table or chart summarizing total number of programs and seats by type.]

### Programs in Dallas County

[ggplot2 map of Dallas Afterschool, CACFP, and HHS programs]

## Current Neighborhood Conditions

[Describe metrics included in Current Neighborhood Conditions and reasons for their inclusion]

### Expected Population

[Summary of population variables for Dallas County. How many families/children do we expect could go to Afterschool programs in the county?]
[Specific family types (Single-mother households, households below poverty, etc.)]

## Methodology 

[Basic description of methodology and reason for use of components]